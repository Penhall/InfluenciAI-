<UserControl x:Class="InfluenciAI.Desktop.Views.UsersView"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
             mc:Ignorable="d"
             Loaded="UserControl_Loaded">
    <UserControl.Resources>
        <BooleanToVisibilityConverter x:Key="BoolToVisibilityConverter"/>
    </UserControl.Resources>
    <Grid Background="{StaticResource PrimaryBackgroundBrush}" Margin="16">
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
            <RowDefinition Height="Auto"/>
        </Grid.RowDefinitions>

        <StackPanel Orientation="Horizontal" Margin="0,0,0,8">
            <TextBlock Text="UsuÃ¡rios" Style="{StaticResource SectionHeaderStyle}"/>
            <TextBlock Text="  " Width="12"/>
            <TextBlock Text="Tenant:" Foreground="{StaticResource PrimaryTextBrush}" VerticalAlignment="Center"/>
            <ComboBox Width="240" Margin="8,0,8,0" ItemsSource="{Binding Tenants}" SelectedItem="{Binding SelectedTenant}" DisplayMemberPath="Name"/>
            <Button Content="Recarregar" Width="110" Margin="4,0" Command="{Binding LoadUsersCommand}"/>
            <TextBox Width="220" Margin="12,0,4,0" Text="{Binding NewEmail, UpdateSourceTrigger=PropertyChanged}"/>
            <PasswordBox Width="160" Margin="4,0" x:Name="Pwd"/>
            <TextBox Width="180" Margin="4,0" Text="{Binding NewDisplayName, UpdateSourceTrigger=PropertyChanged}"/>
            <Button Content="Novo" Width="90" Margin="4,0" Click="Create_Click"/>
            <Button Content="Salvar" Width="90" Margin="4,0" Command="{Binding UpdateUserCommand}"/>
            <Button Content="Remover" Width="90" Margin="4,0" Command="{Binding DeleteUserCommand}"/>
        </StackPanel>

        <DataGrid Grid.Row="1"
                  ItemsSource="{Binding Users}"
                  SelectedItem="{Binding SelectedUser, Mode=TwoWay}"
                  AutoGenerateColumns="False"
                  HeadersVisibility="Column"
                  CanUserAddRows="False"
                  CanUserDeleteRows="False"
                  Background="{StaticResource SecondaryBackgroundBrush}"
                  Foreground="{StaticResource PrimaryTextBrush}"
                  BorderBrush="{StaticResource BorderBrush}"
                  RowBackground="{StaticResource SecondaryBackgroundBrush}"
                  AlternatingRowBackground="{StaticResource AccentBackgroundBrush}">
            <DataGrid.Columns>
                <DataGridTextColumn Header="Email" Binding="{Binding Email, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" Width="2*"/>
                <DataGridTextColumn Header="Nome" Binding="{Binding DisplayName, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" Width="*"/>
                <DataGridTextColumn Header="Id" Binding="{Binding Id}" Width="*"/>
            </DataGrid.Columns>
        </DataGrid>

        <Grid Grid.Row="2">
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="*"/>
                <ColumnDefinition Width="Auto"/>
            </Grid.ColumnDefinitions>
            <TextBlock Text="{Binding Status}"
                       Foreground="{StaticResource ErrorColor}" Margin="0,8,0,0"/>
            <StackPanel Grid.Column="1" Orientation="Horizontal" VerticalAlignment="Center">
                <TextBlock Text="Carregando..." Foreground="{StaticResource SecondaryTextBrush}" Margin="8,8,8,0" Visibility="{Binding Busy, Converter={StaticResource BoolToVisibilityConverter}}"/>
                <ProgressBar Width="120" Height="12" Margin="0,10,0,0" IsIndeterminate="True" Visibility="{Binding Busy, Converter={StaticResource BoolToVisibilityConverter}}"/>
            </StackPanel>
        </Grid>
    </Grid>
</UserControl>
