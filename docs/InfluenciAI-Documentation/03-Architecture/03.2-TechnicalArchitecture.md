# Arquitetura Técnica — Stack e Padrões

Resumo consolidado da stack e padrões técnicos (detalhes em `docs/Motivação/technical-architecture.md`). Atualizado para .NET 10 (RC) com foco em segurança e operabilidade.

Stack principal:

- Backend: .NET 10 (C# 13), ASP.NET Core Minimal API, MediatR, EF Core 10
- Mensageria: Azure Service Bus ou RabbitMQ
- Cache: Redis (Stack com Search/TimeSeries quando aplicável)
- Banco de Dados: PostgreSQL 15+ (principal) + MongoDB (analytics/auxiliar)
- Cliente Desktop: WPF (.NET 8, MVVM)
- Web/Admin: Blazor Server (futuro) e SignalR para tempo real
- Observabilidade: Application Insights, Prometheus, Grafana
- Infraestrutura: Azure (AKS, Key Vault), Docker/Kubernetes, CI/CD Azure DevOps/GitHub Actions

Padrões de projeto:

- Domain: Repository, Unit of Work, Specification, Factory
- Aplicação: CQRS seletivo, Mediator (MediatR), pipelines
- Resiliência: Retry + Exponential Backoff, Circuit Breaker, Bulkhead
- Integração: Outbox Pattern, Cache-Aside

Integrações por rede (exemplos):

- Twitter/X: Tweetinvi + API v2; publicar, coletar métricas, threads
- Instagram: Graph API; feed, stories, reels, agendamento
- LinkedIn: API v2; posts corporativos, rich media
- TikTok: API v2; vídeo vertical, trends; fallback scraping quando permitido
- YouTube: Data API v3; Shorts e vídeos longos

Segurança:

- Identidade: ASP.NET Core Identity + EF Core (AppUser) com roles e políticas
- Autenticação: JWT (claims: `sub`, `name`, `tenant`, `role`); OAuth/OIDC para redes sociais; Device Code Flow no desktop
- Segredos: Azure Key Vault; rotação e acesso mínimo necessário
- Auditoria: trilhas de auditoria para ações críticas

Observabilidade:

- Logs estruturados (correlação), métricas técnicas e de negócio
- Tracing distribuído em fluxos assíncronos
- HealthChecks + UI em `/health/ui`; dashboards por domínio e SLOs por serviço

CORS:
- Provider dinâmico por tenant: `X-Tenant-Id` sobrescreve `AllowedOrigins` quando configurado
- Flag `Cors.AllowAllInDev` para facilitar DX em desenvolvimento
